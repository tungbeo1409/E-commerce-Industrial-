/*! For license information please see playerlite.v1.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.HLSPlayer=t():e.HLSPlayer=t()}(this,(()=>(()=>{function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(){"use strict";o=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(t,n,r,i){var o=n&&n.prototype instanceof p?n:p,a=Object.create(o.prototype);return l(a,"_invoke",function(t,n,r){var i=1;return function(o,a){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=E(s,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===i)throw i=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=3;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?4:2,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=4,r.method="throw",r.arg=c.arg)}}}(t,r,new S(i||[])),!0),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f={};function p(){}function v(){}function m(){}var y={};l(y,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(C([])));b&&b!==n&&r.call(b,s)&&(y=b);var w=m.prototype=p.prototype=Object.create(y);function k(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(o,a,s,u){var c=h(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==i(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}),!0)}function E(t,n){var r=n.method,i=t.i[r];if(i===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=h(i,t.i,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,f;var a=o.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function B(e){this.tryEntries.push(e)}function T(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function S(e){this.tryEntries=[[-1]],e.forEach(B,this),this.reset(!0)}function C(t){if(null!=t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(i(t)+" is not iterable")}return v.prototype=m,l(w,"constructor",m),l(m,"constructor",v),v.displayName=l(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},k(x.prototype),l(x.prototype,u,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new x(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(w),l(w,c,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=C,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o[4],s=this.prev,u=o[1],c=o[2];if(-1===o[0])return r("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=s){if(s<u)return this.method="next",this.arg=e,r(u),!0;if(s<c)return r(c),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var i=r;break}}i&&("break"===e||"continue"===e)&&i[0]<=t&&t<=i[2]&&(i=null);var o=i?i[4]:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i[2],f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),T(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:C(t),r:n,n:r},"next"===this.method&&(this.arg=e),f}},t}function a(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function c(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var d=function(){return n=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"hlsAttachSource",(function(){n.supportType=2,n.vd.playsinline=!0,n.vd.webkitPlaysinline=!0,n.vd.controls=!1,n.vd.src=n.config.src,n.vd.addEventListener("loadedmetadata",(function(){n.duration=n.vd.duration,n.vd.currentTime=0}))})),c(this,"loadNextSegment",s(o().mark((function e(){var t,r,i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isBuffering&&!(n.currentSegmentIndex>=n.segments.length)){e.next=3;break}return n.loadingLayer.style.display="none",e.abrupt("return");case 3:if(t=n.computedTsIndex(n.currentPosTime()),!(n.currentSegmentIndex-t<3&&n.currentSegmentIndex<n.segments.length)){e.next=31;break}if(e.prev=6,r=n.segments[n.currentSegmentIndex]){e.next=10;break}return e.abrupt("return");case 10:return i=n.resolveUrl(n.levelBaseUrl,r.url),a=n.currentSegmentIndex,e.next=14,n.fetchSegment(i);case 14:if(s=e.sent,n.currentSegmentIndex!==a){e.next=21;break}return e.next=18,n.appendBuffer(s);case 18:n.currentSegmentIndex++,e.next=22;break;case 21:return e.abrupt("return");case 22:n.isBuffering&&n.currentSegmentIndex<n.segments.length?n.loadNextSegment():n.mediaSource&&"open"===n.mediaSource.readyState&&(n.mediaSource.endOfStream(),n.isBuffering=!1),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(6),n.isBuffering=!1;case 29:e.next=32;break;case 31:setTimeout((function(){n.isBuffering&&n.loadNextSegment()}),500);case 32:case"end":return e.stop()}}),e,null,[[6,25]])})))),c(this,"isAllSegmentsBuffered",(function(){if(!n.sourceBuffer||!n.sourceBuffer.buffered||0===n.sourceBuffer.buffered.length)return!1;var e=n.sourceBuffer.buffered.end(0)-n.sourceBuffer.buffered.start(0);return Math.abs(e-n.duration)<=n.durationTolerance})),c(this,"onVideoWaiting",(function(){n.loadingLayer.style.display="flex",n.waitTimes++,n.waitTimeArr[n.waitTimes-1]={start:(new Date).getTime()}})),c(this,"onVideoLoadeddata",(function(){if(n.updateTimeDisplay(),n.loadingLayer.style.display="none",n.bigPlayButton&&(n.bigPlayButton.style.display="block"),n.openDuration||(n.openDuration=new Date-n.startTime),n.config.playEndMask)try{var e=document.querySelector("#endMask");n.removeClass(e,"active")}catch(e){}})),c(this,"onVideoPlay",s(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.attachedSource){e.next=4;break}return n.attachedSource=!0,e.next=4,n.attachVideoSource();case 4:if(n.segments.length||n.isMsSupported()&&n.loadVariantPlaylist(),n.posterLayer.style.display="none",n.config.playEndMask)try{t=document.querySelector("#endMask"),n.removeClass(t,"active")}catch(e){}r=n.currentPosTime(),!n.played&&n.loaded&&r>n.playTime&&(n.playTime=r,n.reportInfo("play")),n.played=!0;case 10:case"end":return e.stop()}}),e)})))),c(this,"onVideoPlaying",(function(){n.addClass(n.playPauseBtn,"paused"),n.isDefined(n.bigPlayButton)&&(n.bigPlayButton.style.display="none"),n.loadingLayer.style.display="none",n.isMob&&!n.playStatus&&(n.playStatus=1,n.closeControlsTimer&&clearTimeout(n.closeControlsTimer),n.closeControlsTimer=setTimeout((function(){n.removeClass(n.vdContainer,"active"),clearTimeout(n.closeControlsTimer)}),4e3)),n.config.playing()})),c(this,"onVideoSeeking",(function(){})),c(this,"onVideoSeeked",(function(){n.loadingLayer.style.display="none",n.seekTimes++,n.config.seeked()})),c(this,"onVideoVolumechange",(function(){n.vd.muted||0===n.vd.volume?n.volumeContainer&&n.addClass(n.volumeContainer,"muted"):n.volumeContainer&&n.removeClass(n.volumeContainer,"muted")})),c(this,"onVideoCanplay",(function(){n.waitTimeArr[n.waitTimes-1]&&n.waitTimeArr[n.waitTimes-1].start&&!n.waitTimeArr[n.waitTimes-1].end&&(n.waitTimeArr[n.waitTimes-1].end=(new Date).getTime()),n.loaded=!0,n.isMob&&n.vd.paused&&n.bigPlayButton&&(n.bigPlayButton.style.display="block"),n.config.canplay()})),c(this,"onVideoError",(function(e){n.errorMsg=e,n.reportInfo("error"),n.config.error("video error:",e)})),c(this,"onVideoEnded",(function(){n.updateTimeDisplay(),n.reportTimer&&(clearInterval(n.reportTimer),n.reportTimer=null);var e=n.vd.currentTime;if(e>n.playTime&&(n.playTime=e,n.reportInfo("ended")),n.config.loop)n.vd.currentTime=0,n.currentSegmentIndex=0,n.vd.play();else if(n.vd.pause(),n.loadingLayer.style.display="none",n.loadingLayer.setAttribute("on","false"),n.posterLayer.style.display="block",n.config.playEndMask){var t=document.querySelector("#endMask");n.addClass(t,"active")}n.config.ended()})),c(this,"onVideoPause",(function(){n.removeClass(n.playPauseBtn,"paused"),n.isDefined(n.bigPlayButton)&&(n.bigPlayButton.style.display="block"),n.isMob&&n.playStatus&&(n.playStatus=0,n.closeControlsTimer&&clearTimeout(n.closeControlsTimer),n.addClass(n.vdContainer,"active")),n.config.pause()})),c(this,"onVideoTimeupdate",(function(){if(null==("undefined"==typeof Hls?"undefined":i(Hls))&&n.vd.currentTime>=n.duration-n.durationTolerance)n.onVideoEnded();else{var e=n.currentPosTime()/n.duration*100;n.progress.style.width=e>100?100:e+"%",n.updateTimeDisplay(),n.reportTimer||(n.reportTimer=setInterval((function(){var e=n.currentPosTime();e>n.playTime&&(n.playTime=e,n.reportInfo("timeupdate"))}),n.config.reportInterval)),n.config.timeupdate()}})),c(this,"createPlayer",(function(){n.addClass(n.vdContainer,"vd-container"),n.config.controls&&n.addClass(n.vdContainer,"controls"),n.createVideo(),n.createControls(),n.createPosterLayer(),n.createLoading(),n.config.bigPlayButton&&n.createBigPlayButton(),n.config.playEndMask&&n.createPlayEndMask(),n.isDefined(n.posterLayer)&&n.vdContainer.appendChild(n.posterLayer),n.isDefined(n.bigPlayButton)&&n.vdContainer.appendChild(n.bigPlayButton),n.addEvents(),n.config.ready()})),c(this,"createVideo",(function(){n.vd=n.createElement("video"),n.vd.autoplay=!0,n.vd.loop=n.config.loop,n.vd.playsinline=!0,n.vd.muted=n.config.muted,n.controls=!1,n.vdContainer.appendChild(n.vd),n.config.autoplay&&n.vd.play()})),c(this,"attachVideoSource",(function(){return new Promise(function(){var e=s(o().mark((function e(t,r){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.vd.canPlayType("application/vnd.apple.mpegurl")||n.vd.canPlayType("application/x-mpegURL"),!n.isMsSupported()){e.next=7;break}return e.next=4,n.mseAttachSource();case 4:t(),e.next=8;break;case 7:i?(n.hlsAttachSource(),t()):n.hlsLightAttachSource();case 8:t();case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())})),c(this,"createControls",(function(){n.controls=n.createElement("div","vd-controls"),n.config.playPrevButton&&n.createPrevButton(),n.createPlayButton(),n.config.playNextButton&&n.createNextButton(),n.createVolume(),n.createTimeControl(),n.createProgressBar(),n.createControlSpace(),n.createFullscreenButton(),n.config.controls&&n.vdContainer.appendChild(n.controls)})),c(this,"createPosterLayer",(function(){n.posterLayer=n.createElement("div","poster-layer");var e=n.config.poster;if(e){n.posterLayer.style.backgroundImage="url(".concat(e,")"),n.posterLayer.style.display="block";var t=n.config.posterRatio;if(t){var r=t.split(":");if(2===r.length){var i=r[0],o=r[1];i&&o&&(n.posterLayer.style.backgroundSize=i>o?"contain":"cover")}}}n.posterLayer.addEventListener("click",(function(){n.vd.paused?n.vd.play():n.vd.pause()}))})),c(this,"createLoading",(function(){n.loadingLayer=n.createElement("div","loading-layer");var e=n.createElement("div","loading-spinner");n.loadingLayer.appendChild(e),n.vdContainer.appendChild(n.loadingLayer)})),c(this,"createBigPlayButton",(function(){n.bigPlayButton=n.createElement("button","big-play-button"),n.bigPlayButton.addEventListener("click",(function(){n.vd.paused?n.vd.play():n.vd.pause()}))})),c(this,"createPrevButton",(function(){n.prevBtn=n.createElement("button","play-prev"),n.prevBtn.addEventListener("click",(function(){n.config.playPrev()})),n.controls.appendChild(n.prevBtn)})),c(this,"createNextButton",(function(){n.nextBtn=n.createElement("button","play-next"),n.nextBtn.addEventListener("click",(function(){n.config.playNext()})),n.controls.appendChild(n.nextBtn)})),c(this,"createPlayButton",(function(){n.playPauseBtn=n.createElement("button","play-btn"),n.playPauseBtn.addEventListener("click",(function(){n.vd.paused?n.vd.play():n.vd.pause()})),n.controls.appendChild(n.playPauseBtn)})),c(this,"throttle",(function(e,t){var n=null;return function(){n||(e.apply(this,arguments),n=setTimeout((function(){n=null}),t))}})),c(this,"createVolume",(function(){n.volumeContainer=n.createElement("div","volume-container");var e=n.createElement("button","volume-btn");n.config.muted&&n.addClass(n.volumeContainer,"muted"),n.volumeContainer.appendChild(e);var t=n.createElement("div","volume-bar-container"),r=n.createElement("div","custom-volume-bar"),i=n.createElement("div","custom-volume-level");r.appendChild(i),t.appendChild(r),n.volumeContainer.appendChild(t),e.addEventListener("click",(function(){n.vd.muted?(n.vd.muted=!1,o(),n.removeClass(n.volumeContainer,"muted")):(n.vd.muted=!0,o(),n.addClass(n.volumeContainer,"muted"))}));var o=function(){var e=n.vd.muted?0:n.vd.volume;i.style.width="".concat(100*e,"%")};o(),t.addEventListener("click",(function(r){var i=t.getBoundingClientRect(),a=(r.clientX-i.left)/i.width;n.vd.volume=a,n.vd.muted=!1,n.removeClass(e,"muted"),o()})),n.handleProgressInteraction(t,(function(t){n.vd.volume=t,n.vd.muted=!1,n.removeClass(e,"muted"),o()})),n.controls.appendChild(n.volumeContainer)})),c(this,"createTimeControl",(function(){n.timeControl=n.createElement("span","time-control"),n.controls.appendChild(n.timeControl)})),c(this,"updateTimeDisplay",(function(){var e=n.formatTime(n.currentPosTime()>n.duration?n.duration:n.currentPosTime()),t=n.formatTime(n.duration);n.timeControl.textContent="".concat(e," / ").concat(t)})),c(this,"createProgressBar",(function(){n.progressBarContainer=n.createElement("div","progress-bar-container");var e=n.createElement("div","progress-bar");n.progress=n.createElement("div","progress"),e.appendChild(n.progress),n.progressBarContainer.appendChild(e),e.addEventListener("click",(function(t){var r=e.getBoundingClientRect(),i=(t.clientX-r.left)/r.width,o=i*n.duration;n.currentTime(o),n.progress.style.width="".concat(100*i,"%!important")})),n.handleProgressInteraction(e,(function(e){var t=e*n.duration;n.currentTime(t),n.progress.style.width="".concat(100*e,"%!important")})),n.controls.appendChild(n.progressBarContainer)})),c(this,"createFullscreenButton",(function(){n.fullscreenBtn=n.createElement("button","fullscreen-btn"),n.fullscreenBtn.addEventListener("click",(function(){n.vd.requestFullscreen?n.vd.requestFullscreen():n.vd.webkitRequestFullscreen?n.vd.webkitRequestFullscreen():n.vd.msRequestFullscreen&&n.vd.msRequestFullscreen()})),n.controls.appendChild(n.fullscreenBtn)})),c(this,"createControlSpace",(function(){var e=n.createElement("span","control-space");n.controls.appendChild(e)})),c(this,"handleProgressInteraction",(function(e,t){var r=!1,i=null;e.addEventListener("mousedown",(function(t){r=!0;var n=e.getBoundingClientRect();t.clientX,n.left,n.width,t.preventDefault(),document.addEventListener("mousemove",o),document.addEventListener("mouseup",a)}));var o=n.throttle((function(n){if(r){var s=e.getBoundingClientRect();n.clientX>=s.left&&n.clientX<=s.right?(cancelAnimationFrame(i),i=requestAnimationFrame((function(){var e=Math.min(Math.max(n.clientX-s.left,0),s.width)/s.width;t(e)}))):(r=!1,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a))}}),16),a=function(){r&&(r=!1,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a))}})),c(this,"createElement",(function(e,t){var r=document.createElement(e);return t&&n.addClass(r,t),r})),c(this,"hasClass",(function(e,t){return e&&e.classList.contains(t)})),c(this,"addClass",(function(e,t){e&&t&&!e.classList.contains(t)&&e.classList.add(t)})),c(this,"removeClass",(function(e,t){e&&t&&e.classList.remove(t)})),c(this,"isDefined",(function(e){return null!=e})),c(this,"isMsSupported",(function(){var e=window.MediaSource||window.WebKitMediaSource,t=!!e,n=!(!window.SourceBuffer&&!window.WebKitSourceBuffer),r=e&&e.isTypeSupported('video/mp2t; codecs="avc1.42E01E, mp4a.40.2"');return t&&n&&r})),this.levels=[],this.activeLevel=null,this.preloadCount=1,this.durationTolerance=.5,this.segments=[],this.duration=0,this.currentSegmentIndex=0,this.baseUrl="",this.levelBaseUrl="",this.mediaSource=null,this.sourceBuffer=null,this.loadedSegments=new Map,this.startTime=new Date,this.openDuration=0,this.waitTimes=0,this.waitTimeArr=[],this.loaded=!1,this.played=!1,this.playTime=0,this.reportTimer=null,this.seekTimes=0,this.errorMsg="",this.isFirstReport=!1,this.playerTimeStamp=parseInt(Date.parse(new Date)/1e3),this.playStatus=0,this.closeControlsTimer=null,this.config={autoplay:!1,loop:!1,poster:"",src:"",hlsUrl:"./hls.light.min.js",bigPlayButton:!0,playNextButton:!1,playPrevButton:!1,controls:!0,muted:!1,playEndMask:!1,reportInterval:1e4,posterRatio:0,error:function(){},playing:function(){},pause:function(){},canplay:function(){},ready:function(){},ended:function(){},seeked:function(){},timeupdate:function(){},playNext:function(){},playPrev:function(){}},this.vdContainer=null,this.isMob=this.isMobile(),this.vd=null,this.controls=null,this.posterLayer=null,this.loadingLayer=null,this.bigPlayButton=null,this.prevBtn=null,this.nextBtn=null,this.playPauseBtn=null,this.volumeContainer=null,this.timeControl=null,this.progressBarContainer=null,this.fullscreenBtn=null,this.progress=null,this.attachedSource=!1,this.supportType=1,this.init(t)},r=[{key:"init",value:function(e){e.videoElement?(this.vdContainer=e.videoElement,Object.assign(this.config,e),this.createPlayer()):this.config.error("no video element.")}},{key:"mseAttachSource",value:(w=s(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.supportType=1,e.prev=1,this.baseUrl=this.config.src.substring(0,this.config.src.lastIndexOf("index.html")+1),this.mediaSource=new MediaSource,this.vd.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",(function(){n.sourceBuffer=n.mediaSource.addSourceBuffer('video/mp2t; codecs="avc1.42E01E, mp4a.40.2"'),n.sourceBuffer.mode="sequence"}),{once:!0}),e.next=8,this.parseMasterPlaylist(this.config.src);case 8:t=e.sent,this.levels=t,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return w.apply(this,arguments)})},{key:"loadScript",value:function(e){return new Promise((function(t,n){var r=document.createElement("script");r.src=e,r.onload=t,r.onerror=function(){return n(new Error("Failed to load script: ".concat(e)))},document.body.appendChild(r)}))}},{key:"hlsLightAttachSource",value:(b=s(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"undefined"!=typeof Hls){e.next=6;break}if(this.config.hlsUrl){e.next=4;break}throw new Error("Hls is not defined and no hlsUrl provided");case 4:return e.next=6,this.loadScript(this.config.hlsUrl);case 6:this.supportType=3,this.hls=new Hls({enableWorker:!1,enableSoftwareAES:!0,forceKeyFrameOnDiscontinuity:!0,capLevelToPlayerSize:!0,maxBufferLength:300,backBufferLength:60,manifestLoadingMaxRetry:5,fragLoadingMaxRetry:10}),this.hls.loadSource(this.config.src),this.hls.attachMedia(this.vd),this.vd.addEventListener("loadedmetadata",(function(){t.duration=t.vd.duration,t.vd.currentTime=0})),this.hls.on(Hls.Events.ERROR,(function(e,t){if(t.fatal)switch(t.type){case Hls.ErrorTypes.NETWORK_ERROR:break;case Hls.ErrorTypes.MEDIA_ERROR:hls.recoverMediaError()}})),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(){return b.apply(this,arguments)})},{key:"loadVariantPlaylist",value:(g=s(o().mark((function e(){var t,n,r,i,a,s,u,c,l,d,h,f,p,v,m,y,g,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.selectBestResolution())<0||t>=this.levels.length)){e.next=4;break}return e.abrupt("return");case 4:if(this.activeLevel=this.levels[t],this.activeLevel&&this.activeLevel.url){e.next=8;break}return e.abrupt("return");case 8:return n=this.resolveUrl(this.baseUrl,this.activeLevel.url),this.levelBaseUrl=n.substring(0,n.lastIndexOf("index.html")+1),e.next=12,this.parseLevelPlaylist(n);case 12:if(r=e.sent,i=r.segments,a=r.duration,this.segments=i,this.duration=a,this.sourceBuffer||(this.sourceBuffer=this.mediaSource.addSourceBuffer('video/mp2t; codecs="avc1.42E01E, mp4a.40.2"'),this.sourceBuffer.mode="sequence"),this.sourceBuffer.buffered.length>0&&!1===this.sourceBuffer.updating)try{this.sourceBuffer.remove(0,this.sourceBuffer.buffered.end(0))}catch(e){}s=this.currentPosTime(),u=0,c=0,l=0;case 23:if(!(l<this.segments.length)){e.next=31;break}if(!((c+=this.segments[l].duration)>=s)){e.next=28;break}return u=l,e.abrupt("break",31);case 28:l++,e.next=23;break;case 31:for(d=u,h=this.preloadCount,f=[],p=0;p<h&&d+p<this.segments.length;p++)v=this.segments[d+p],m=this.resolveUrl(this.levelBaseUrl,v.url),f.push(this.fetchSegment(m));return e.next=37,Promise.all(f);case 37:y=e.sent,g=0;case 39:if(!(g<y.length)){e.next=51;break}if(b=y[g],this.segments[d+g]){e.next=44;break}return e.abrupt("continue",48);case 44:return e.next=46,this.appendBuffer(b);case 46:1==g&&this.vd.paused&&this.vd.play(),this.currentSegmentIndex++;case 48:g++,e.next=39;break;case 51:this.isBuffering=!0,this.loadNextSegment();case 53:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"appendBuffer",value:(y=s(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(n.vd.error)return r(),null;if(!n.mediaSource||"open"!==n.mediaSource.readyState)return r(),null;if(!n.sourceBuffer)return r(),null;if(!(t instanceof ArrayBuffer))return r(),null;var i=function(){n.sourceBuffer.removeEventListener("updateend",a),n.sourceBuffer.removeEventListener("error",o)},o=function(e){i(),r()},a=function(){i(),e()};if(n.sourceBuffer.addEventListener("error",o,{once:!0}),n.sourceBuffer.addEventListener("updateend",a,{once:!0}),n.sourceBuffer.updating)n.sourceBuffer.updating&&(n.sourceBuffer.abort(),setTimeout((function(){try{n.sourceBuffer.appendBuffer(t)}catch(e){o(e)}}),100));else try{n.sourceBuffer.appendBuffer(t)}catch(e){o(e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"computedTsIndex",value:function(e){for(var t=0,n=0;n<this.segments.length;n++){var r=this.segments[n].duration;if(e>=t&&e<t+r)return n;t+=r}return Math.max(0,this.segments.length-1)}},{key:"currentTime",value:(m=s(o().mark((function e(t){var n,r,i,a,s,u,c,l,d,h,f,p=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hls||!this.vd){e.next=4;break}this.vd.currentTime=t,e.next=44;break;case 4:if(this.isBuffering=!1,this.activeLevel&&this.sourceBuffer){e.next=8;break}return e.abrupt("return");case 8:if(e.prev=8,n=this.computedTsIndex(t),r=this.vd.buffered,i=!1,r.length>0){for(a=0,s=0;s<n;s++)a+=this.segments[s].duration;u=a+this.segments[n].duration,c=this.sourceBuffer.buffered.end(0),i=r.start(0)<=a&&r.end(0)>=u||c>=u}if(i){e.next=31;break}if(!(this.sourceBuffer.buffered.length>0)||this.sourceBuffer.updating){e.next=17;break}return e.next=17,new Promise((function(e,t){var n=function(){p.sourceBuffer.removeEventListener("updateend",n),e()};p.sourceBuffer.addEventListener("updateend",n,{once:!0}),p.sourceBuffer.remove(0,p.sourceBuffer.buffered.end(0))}));case 17:return this.currentSegmentIndex=n,l=this.segments[n],d=this.resolveUrl(this.levelBaseUrl,l.url),e.next=22,this.fetchSegment(d);case 22:return h=e.sent,e.next=25,this.appendBuffer(h);case 25:this.currentSegmentIndex++,f=setInterval((function(){p.vd.currentTime=t,p.vd.paused?p.vd.play():clearTimeout(f)}),1e3),this.isBuffering=!0,this.loadNextSegment(),e.next=35;break;case 31:if(this.vd.currentTime=t,!this.vd.paused){e.next=35;break}return e.next=35,this.vd.play();case 35:if(this.sourceBuffer&&!this.sourceBuffer.updating){e.next=38;break}return e.next=38,new Promise((function(e){var t=function(){p.sourceBuffer.removeEventListener("updateend",t),e()};p.sourceBuffer.addEventListener("updateend",t,{once:!0})}));case 38:e.next=44;break;case 40:e.prev=40,e.t0=e.catch(8),this.isBuffering||this.loadVariantPlaylist();case 44:case"end":return e.stop()}}),e,this,[[8,40]])}))),function(e){return m.apply(this,arguments)})},{key:"addEvents",value:function(){var e=this;this.vd.addEventListener("waiting",this.onVideoWaiting),this.vd.addEventListener("loadeddata",this.onVideoLoadeddata),this.vd.addEventListener("play",this.onVideoPlay),this.vd.addEventListener("playing",this.onVideoPlaying),this.vd.addEventListener("canplay",this.onVideoCanplay),this.vd.addEventListener("error",this.onVideoError),this.vd.addEventListener("ended",this.onVideoEnded),this.vd.addEventListener("pause",this.onVideoPause),this.vd.addEventListener("timeupdate",this.onVideoTimeupdate),this.vd.addEventListener("seeking",this.onVideoSeeking),this.vd.addEventListener("seeked",this.onVideoSeeked),this.vd.addEventListener("volumechange",this.onVideoVolumechange),this.vd.addEventListener("loadstart",(function(){})),this.vd.addEventListener("click",(function(){e.vd.paused?e.vd.play():e.vd.pause()}))}},{key:"togglePlay",value:function(e){this.hasClass(e,"playing")?(this.removeClass(e,"playing"),this.addClass(e,"paused")):(this.removeClass(e,"paused"),this.addClass(e,"playing"))}},{key:"reportInfo",value:(v=s(o().mark((function e(t){var n,r,i,a,s,u,c,l,d,h,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=parseInt(Date.parse(new Date)/1e3),r=this.getUrlData(this.config.src),i=r.videoId,a=r.typeId,s=this.config.src.indexOf("testvodcdn")>=0,u="https://".concat(s?"testvod":"vod",".ecerimg.com/view_count/report"),c=isNaN(a),window.playerReportUrl&&(u=window.playerReportUrl),l=this.levels.map((function(e){return e.resolution.split("x")[1]})),e.next=10,this.sha256(""+a+n+"EcerVideo#2o22");case 10:return d=e.sent,e.next=13,this.sha256(""+a+i+this.playerTimeStamp,32);case 13:h=e.sent,f={timestamp:n,type_id:c?0:parseInt(a),sign:d,alg:"sha256",video_id:i,sid:h,device:~~this.isMob,duration:Math.round(this.duration||0),pos:this.currentPosTime(),from:location.href,reportType:t,version:"1.0.4",stat:{openTime:this.openDuration,resolution:l.join(","),waitingTime:this.computedWaitTime(this.waitTimeArr)||"",errorMsg:this.errorMsg,seekTimes:this.seekTimes}},c&&Object.assign(f,{source:this.config.src}),this.isFirstReport||(this.isFirstReport=!0,f.stat.userAgent=navigator&&navigator.userAgent||""),fetch(u,{method:"POST",body:JSON.stringify(f)});case 18:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"sha256",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-256",n).then((function(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("").substring(0,t)}))}},{key:"getUrlData",value:function(e){var t=e.split("index.html"),n=t.length;return{videoId:n>=3?t[n-2]:0,typeId:n>=3?t[n-3].substr(0,t[n-3].length-6):0}}},{key:"computedWaitTime",value:function(e){var t=[];return e.forEach((function(e){e.end&&e.start&&t.push(e.end-e.start)})),t.join(",")}},{key:"currentPosTime",value:function(){return this.vd?Math.ceil(this.vd.currentTime):0}},{key:"src",value:(p=s(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.isBuffering=!1,this.mediaSource&&(this.mediaSource.endOfStream(),this.mediaSource=null),this.levels=[],this.activeLevel=null,this.segments=[],this.duration=0,this.currentSegmentIndex=0,this.baseUrl="",this.levelBaseUrl="",this.sourceBuffer=null,this.config.src=t,e.next=16,this.attachVideoSource();case 16:this.config.autoplay&&this.vd.play(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2);case 22:case"end":return e.stop()}}),e,this,[[2,19]])}))),function(e){return p.apply(this,arguments)})},{key:"createPlayEndMask",value:function(){if(!document.querySelector(".play-end-mask")){var e=this.createElement("div","play-end-mask");e.id="endMask",this.vdContainer&&this.vdContainer.appendChild(e)}}},{key:"resetConfig",value:function(){this.mediaSource&&(this.mediaSource.endOfStream(),this.mediaSource=null),this.levels=[],this.activeLevel=null,this.segments=[],this.duration=0,this.currentSegmentIndex=0,this.baseUrl="",this.levelBaseUrl="",this.sourceBuffer=null,this.startTime=new Date,this.openDuration=0,this.waitTimes=0,this.waitTimeArr=[],this.loaded=!1,this.played=!1,this.playTime=0,this.seekTimes=0,this.errorMsg="",this.isFirstReport=!1,this.playerTimeStamp=parseInt(Date.parse(new Date)/1e3),this.reportTimer&&(clearInterval(this.reportTimer),this.reportTimer=null)}},{key:"destroy",value:function(){this.resetConfig(),this.config={autoplay:!1,loop:!1,poster:"",src:"",bigPlayButton:!0,playNextButton:!1,playPrevButton:!1,controls:!0,error:function(){},playing:function(){},pause:function(){},canplay:function(){},ready:function(){},ended:function(){},seeked:function(){},timeupdate:function(){},playNext:function(){},playPrev:function(){}},this.vd&&(this.vd.removeEventListener("ended",this.onVideoEnded),this.vd.removeEventListener("pause",this.onVideoPause),this.vd.removeEventListener("play",this.onVideoPlay),this.vd.removeEventListener("timeupdate",this.onVideoTimeupdate),this.vd.removeEventListener("waiting",this.onVideoWaiting),this.vd.removeEventListener("loadeddata",this.onVideoLoadeddata),this.vd.removeEventListener("canplay",this.onVideoCanplay),this.vd.removeEventListener("error",this.onVideoError),this.vd.removeEventListener("seeking",this.onVideoSeeking),this.vd.removeEventListener("seeked",this.onVideoSeeked),this.vd.removeEventListener("playing",this.onVideoPlaying),this.vd.src="",this.vd=null),this.vdContainer&&(this.vdContainer.innerHTML="",this.vdContainer.removeAttribute("controls"),this.vdContainer=null),this.posterLayer=null,this.loadingLayer=null,this.bigPlayButton=null,this.prevBtn=null,this.nextBtn=null,this.playPauseBtn=null,this.volumeContainer=null,this.timeControl=null,this.progressBarContainer=null,this.fullscreenBtn=null,this.progress=null}},{key:"fetchM3u8",value:(f=s(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status));case 5:return e.abrupt("return",n.text());case 6:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"fetchSegment",value:(h=s(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status));case 5:return this.loadedSegments.set(t,!0),e.abrupt("return",n.arrayBuffer());case 7:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"resolveUrl",value:function(e,t){return t.startsWith("http")?t:(e.endsWith("index.html")&&(e=e.substring(0,e.length-1)),t.startsWith("index.html")&&(t=t.substring(1)),"".concat(e,"index.html").concat(t))}},{key:"parseMasterPlaylist",value:(d=s(o().mark((function e(t){var n,r,i,a,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchM3u8(t);case 2:for(n=e.sent,r=[],i=n.split("\n"),a=0;a<i.length;a++)i[a].startsWith("#EXT-X-STREAM-INF")&&(s=this.parseAttributes(i[a]),(u=i[a+1])&&!u.startsWith("#")&&u.trim()&&(r.push({bandwidth:parseInt(s.BANDWIDTH||0),resolution:s.RESOLUTION||"0x0",url:u.trim()}),a++));return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"parseLevelPlaylist",value:(l=s(o().mark((function e(n){var r,i,a,s,u,c,l,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchM3u8(n);case 2:r=e.sent,i=[],a=r.split("\n"),s=0,u=0,c=t(a);try{for(c.s();!(l=c.n()).done;)(d=l.value).startsWith("#EXTINF:")?s=parseFloat(d.split(":")[1].split(",")[0]):d.endsWith(".ts")&&!d.startsWith("#")&&(i.push({url:d,duration:s}),u+=s)}catch(e){c.e(e)}finally{c.f()}return e.abrupt("return",{segments:i,duration:u});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"parseAttributes",value:function(t){return t.split(/[:,]/).slice(1).reduce((function(t,n){var r=e(n.split("="),2),i=r[0],o=r[1];return i&&o&&(t[i.trim()]=o.replace(/"/g,"")),t}),{})}},{key:"selectBestResolution",value:function(){var e=this;if(0===this.levels.length)return null;var t=this.getPlayerDisplaySize(this.vd),n=t.width,r=(t.height,this.getEstimatedBandwidth()),i=this.levels.filter((function(t){var r=t.resolution.split("x");return e.isMob?t:r[0]<=1.5*n})),o=i.length>0?i:this.levels,a=o.filter((function(e){return e.bandwidth<=r}));return a=a.length>0?a.sort((function(e,t){return t.bandwidth-e.bandwidth}))[0]:o[0],o.findIndex((function(e){return e.bandwidth===a.bandwidth}))||0}},{key:"getPlayerDisplaySize",value:function(e){var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}},{key:"getEstimatedBandwidth",value:function(){var e;return null!==(e=navigator.connection)&&void 0!==e&&e.downlink?1e6*navigator.connection.downlink*.8:this.isMob?1e6:2e6}},{key:"isMobile",value:function(){var e=navigator.userAgent||navigator.vendor;return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile|tablet|ipad|playbook|silk/i.test(e)}},{key:"formatTime",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))}},{key:"muted",value:function(e){if(void 0===e)return this.vd.muted;this.vd.muted=e}},{key:"unmute",value:function(){this.vd.muted=!1}}],r&&u(n.prototype,r),a&&u(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a,l,d,h,f,p,v,m,y,g,b,w}();return window.EPlayer=d,{}})()));